<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search - Spotify</title>
    <link rel="stylesheet" href="./styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Config -->
    <script src="js/config.js"></script>
    <script src="js/common.js"></script>
</head>
<script src="js/musicPlayer.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', async () => {
        window.player = new MusicPlayer();

        const searchInput = document.querySelector('.search-input');
        const searchResults = document.querySelector('.search-results');

        searchInput.addEventListener('input', async (e) => {
            const searchTerm = e.target.value.toLowerCase();
            if (searchTerm.length > 0) {
                try {
                    const tracks = await window.player.loadTracks();
                    
                    const filteredTracks = tracks.filter(track => 
                        track.title.toLowerCase().includes(searchTerm) ||
                        track.artist.toLowerCase().includes(searchTerm)
                    );
                    
                    searchResults.innerHTML = '';
                    filteredTracks.forEach((track, index) => {
                        const resultElement = document.createElement('div');
                        resultElement.className = 'search-result';
                        resultElement.innerHTML = `
                            <img src="${track.cover_url}" alt="${track.title}">
                            <div class="result-info">
                                <h3>${track.title}</h3>
                                <p>${track.artist}</p>
                            </div>
                        `;
                        
                        resultElement.addEventListener('click', async () => {
                            await window.player.loadTrack(tracks.indexOf(track));
                            window.player.togglePlayPause();
                        });
                        
                        searchResults.appendChild(resultElement);
                    });
                } catch (error) {
                    console.error('Error searching tracks:', error);
                }
            } else {
                searchResults.innerHTML = '';
            }
        });
    });
</script>
<body>
    <div class="sidebar">
        <div class="logo">
            <a href="index.html">
                <img src="https://storage.googleapis.com/pr-newsroom-wp/1/2018/11/Spotify_Logo_CMYK_Green.png" alt="Logo" />
            </a>
        </div>

        <div class="navigation">
            <ul>
                <li>
                    <a href="index.html">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </a>
                </li>
                <li class="active">
                    <a href="search.html">
                        <i class="fas fa-search"></i>
                        <span>Search</span>
                    </a>
                </li>
                <li>
                    <a href="playlists.html">
                        <i class="fas fa-book"></i>
                        <span>Your Library</span>
                    </a>
                </li>
            </ul>
        </div>

        <div class="navigation">
            <ul>
                <li>
                    <a href="playlists.html">
                        <i class="fas fa-plus-square"></i>
                        <span>Create Playlist</span>
                    </a>
                </li>
                <li>
                    <a href="liked-songs.html">
                        <i class="fas fa-heart"></i>
                        <span>Liked Songs</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div class="main-container">
        <div class="topbar">
            <div class="prev-next-buttons">
                <button><i class="fas fa-chevron-left"></i></button>
                <button><i class="fas fa-chevron-right"></i></button>
            </div>

            <div class="navbar">
                <ul>
                    <li>
                        <a href="#">Premium</a>
                    </li>
                    <li>
                        <a href="#">Download</a>
                    </li>
                    <li class="divider">|</li>
                </ul>
                <div class="navbar-right">
                    <!-- This will be updated by common.js -->
                </div>
            </div>
        </div>

        <div class="search-container">
            <form class="search-form">
                <div class="search-bar">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="What do you want to listen to?">
                </div>
            </form>
            
            <div class="search-results">
                <h2>Browse all</h2>
                <div class="category-grid">
                    <div class="category-card">
                        <h3>Podcasts</h3>
                        <img src="https://picsum.photos/seed/podcasts/100/100" alt="Podcasts">
                    </div>
                    <div class="category-card">
                        <h3>Made For You</h3>
                        <img src="https://picsum.photos/seed/made-for-you/100/100" alt="Made For You">
                    </div>
                    <div class="category-card">
                        <h3>Charts</h3>
                        <img src="https://picsum.photos/seed/charts/100/100" alt="Charts">
                    </div>
                    <div class="category-card">
                        <h3>New Releases</h3>
                        <img src="https://picsum.photos/seed/new-releases/100/100" alt="New Releases">
                    </div>
                    <div class="category-card">
                        <h3>Discover</h3>
                        <img src="https://picsum.photos/seed/discover/100/100" alt="Discover">
                    </div>
                    <div class="category-card">
                        <h3>Concerts</h3>
                        <img src="https://picsum.photos/seed/concerts/100/100" alt="Concerts">
                    </div>
                    <div class="category-card">
                        <h3>Mood</h3>
                        <img src="https://picsum.photos/seed/mood-music/100/100" alt="Mood">
                    </div>
                    <div class="category-card">
                        <h3>Party</h3>
                        <img src="https://picsum.photos/seed/party/100/100" alt="Party">
                    </div>
                    <div class="category-card">
                        <h3>Rock</h3>
                        <img src="https://picsum.photos/seed/rock-music/100/100" alt="Rock">
                    </div>
                    <div class="category-card">
                        <h3>Hip Hop</h3>
                        <img src="https://picsum.photos/seed/hiphop/100/100" alt="Hip Hop">
                    </div>
                    <div class="category-card">
                        <h3>Pop</h3>
                        <img src="https://picsum.photos/seed/pop-music/100/100" alt="Pop">
                    </div>
                    <div class="category-card">
                        <h3>Indie</h3>
                        <img src="https://picsum.photos/seed/indie/100/100" alt="Indie">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="player">
        <div class="now-playing">
            <div class="song-info">
                <img src="images\image.jpg" alt="Current Song" class="current-song-image">
                <div class="song-details">
                    <h4>K.</h4>
                    <p>Cigarettes After Sex</p>
                </div>
                <button class="like-button"><i class="fas fa-heart"></i></button>
            </div>
        </div>
        <div class="player-controls">
            <div class="control-buttons">
                <button class="shuffle"><i class="fas fa-random"></i></button>
                <button class="previous"><i class="fas fa-step-backward"></i></button>
                <button class="play-pause"><i class="fas fa-play"></i></button>
                <button class="next"><i class="fas fa-step-forward"></i></button>
                <button class="repeat"><i class="fas fa-redo"></i></button>
            </div>
            <div class="progress-container">
                <span class="current-time">0:00</span>
                <div class="progress-bar">
                    <div class="progress"></div>
                </div>
                <span class="total-time">3:45</span>
            </div>
        </div>
        <div class="volume-controls">
            <button class="volume-button"><i class="fas fa-volume-up"></i></button>
            <div class="volume-slider">
                <div class="volume-progress"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
